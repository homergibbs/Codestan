<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Bienvenue au Codestan</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f7f9fc;
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        .avatar-thumb {
            height: 50px;
            width: 50px;
            object-fit: cover;
            border-radius: 50%;
        }
        .neon {
            /* Optional future neon glow */
            color: #0ff;
            text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff;
        }
    </style>
</head>

<body>
<div class="container">
    <div class="row">
        <!-- üß≥ Left Side (2/3) -->
        <div class="col-md-8 text-center">
            <h1 class="mb-4">Bienvenue au Codestan üõÇ</h1>

            <img src="{{ url_for('static', filename='ui/border_entry_codestan.png') }}"
                 alt="Entr√©e Codestan"
                 class="img-fluid rounded shadow-sm mb-4" style="max-height: 400px;">

            <p class="lead text-center">Veuillez pr√©senter votre passeport pour entrer dans la zone d'entra√Ænement.</p>

            <form method="POST" action="/check-user" class="mt-4" style="max-width: 500px; margin: auto;">
              <div class="mb-3 text-center">
                <label for="name" class="form-label fs-5 text-center">Quel est votre nom ?</label>
                <input type="text"
                       class="form-control form-control-lg text-center"
                       id="name"
                       name="name"
                       required
                       autocomplete="name"
                       placeholder="Entrez votre nom ici"
                       oninput="checkName(this.value)">
              </div>

              <div class="mb-3 text-center" id="password-wrapper" style="display: none;">
                <label for="password" class="form-label">Mot de passe</label>
                <input type="password"
                       class="form-control text-center"
                       id="password"
                       name="password"
                       autocomplete="current-password"
                       placeholder="Entrez votre mot de passe">
              </div>

              {% if error %}
                <div class="alert alert-danger text-center">{{ error }}</div>
              {% endif %}

              <div class="text-center mt-3">
                <button type="submit" class="btn btn-success btn-lg">Continuer</button>
              </div>
            </form>

        </div>

        <!-- üèÜ Right Side: Leaderboard -->
        <div class="col-md-4 mt-4 mt-md-0">
          <div class="card shadow-sm">
            <div class="card-body">
              <h5 class="card-title text-center">üèÜ Classement g√©n√©ral</h5>

              <!-- Meilleur score -->
              <div class="text-center mb-4 pb-3 border-bottom">
                <p class="fw-bold mb-2">ü•á Meilleur score</p>
                {% if top_score %}
                  <img src="{{ url_for('static', filename='avatars/' ~ top_score.avatar) }}" class="avatar-thumb mb-2">
                  <p>{{ top_score.name | capitalize }} ‚Äî {{ top_score.score }} pts</p>
                {% else %}
                  <p class="text-muted">Aucun score disponible</p>
                {% endif %}
              </div>

              <!-- Meilleure s√©rie -->
              <div class="text-center mb-4 pb-3 border-bottom">
                <p class="fw-bold mb-2">üî• Meilleure s√©rie</p>
                {% if top_streak %}
                  <img src="{{ url_for('static', filename='avatars/' ~ top_streak.avatar) }}" class="avatar-thumb mb-2">
                  <p>{{ top_streak.name | capitalize }} ‚Äî {{ top_streak.best_streak }} bonnes r√©ponses</p>
                {% else %}
                  <p class="text-muted">Aucune s√©rie disponible</p>
                {% endif %}
              </div>

              <!-- Connexions cons√©cutives -->
              <div class="text-center">
                <p class="fw-bold mb-2">üìÜ Connexions cons√©cutives</p>
                {% if top_login %}
                  <img src="{{ url_for('static', filename='avatars/' ~ top_login.avatar) }}" class="avatar-thumb mb-2">
                  <p>{{ top_login.name | capitalize }} ‚Äî {{ top_login.get("login_streak", 0) }} jours</p>
                {% else %}
                  <p class="text-muted">Aucune donn√©e</p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
    </div>
</div>

<script>
  const knownUsers = {{ known_users | tojson }};
  const passwordWrapper = document.getElementById("password-wrapper");

  function checkName(value) {
    const name = value.trim().toLowerCase();
    if (knownUsers.includes(name)) {
      passwordWrapper.style.display = "block";
    } else {
      passwordWrapper.style.display = "none";
    }
  }
</script>


</body>
</html>
